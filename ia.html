<!DOCTYPE html>
<html lang="es">
<head>

<!-- SEO -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>YLMIA - Yalmil.com</title>

<link rel="icon" href="https://cdn.discordapp.com/emojis/1416607460201857168.png?v=1" type="image/png">
<link rel="canonical" href="https://yalmil.pages.dev">

<meta name="title" content="Yalmil.com - Juega, crea, imagina.">
<meta name="description" content="Yalmil.com es una página web para divertirte con los juegos disponibles.">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="Yalmil.com - Juega, crea, imagina.">
<meta property="og:description" content="YLMIA B2 ya disponible!">
<meta property="og:image" content="https://cdn.discordapp.com/attachments/1355008732576088204/1402309070014124102/Screenshot_20250804-221210.png">
<meta property="og:url" content="https://yalmil.github.io/Yalmil.com/">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Yalmil.com - Juega, crea, imagina.">
<meta name="twitter:description" content="YLMIA B2 ya disponible!">
<meta name="twitter:image" content="https://cdn.discordapp.com/attachments/1355008732576088204/1402309070014124102/Screenshot_20250804-221210.png">

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:'Poppins',sans-serif;
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

@keyframes fadeIn{
  from{opacity:0;transform:translateY(6px)}
  to{opacity:1;transform:translateY(0)}
}

main{
  flex:1;
  display:flex;
  flex-direction:column;
}

.chat-container{
  flex:1;
  overflow-y:auto;
  padding:1.5rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
  backdrop-filter:blur(14px);
}

.message{
  max-width:78%;
  padding:.95rem 1.2rem;
  border-radius:14px;
  font-size:.95rem;
  line-height:1.5;
  white-space:pre-wrap;
  word-break:break-word;
  animation:fadeIn .25s;
}

.user-message{align-self:flex-end}
.ai-message{align-self:flex-start}

pre{
  background:rgba(0,0,0,.45);
  padding:.8rem;
  border-radius:10px;
  overflow-x:auto;
}

.input-container{
  padding:1.2rem;
  backdrop-filter:blur(20px);
  border-top:1px solid rgba(255,255,255,.1);
}

textarea{
  width:100%;
  padding:1rem;
  font-size:1rem;
  border-radius:12px;
  border:2px solid;
  background:rgba(255,255,255,.08);
  outline:none;
  resize:none;
  min-height:52px;
  max-height:180px;
}

@media(prefers-color-scheme:dark){
  body{background:linear-gradient(135deg,#0b0b0b,#1c0020);color:#e7d4ff}
  textarea{color:#e7d4ff;border-color:#c084fc}
  .user-message{background:rgba(192,132,252,.22)}
  .ai-message{background:rgba(100,60,160,.22)}
}

@media(prefers-color-scheme:light){
  body{background:linear-gradient(135deg,#330a00,#662000);color:#ffd8a6}
  textarea{color:#ffd8a6;border-color:#ff8c00}
  .user-message{background:rgba(255,140,0,.22)}
  .ai-message{background:rgba(255,195,120,.22)}
}
</style>
</head>

<body>

<main>
  <div class="chat-container" id="chatContainer">
    <div class="message ai-message">⚡ Hola, soy tu IA. En que te ayudo?</div>
  </div>

  <div class="input-container">
    <textarea id="userInput" placeholder="Escribe tu mensaje y pulsa Enter..." disabled></textarea>
  </div>
</main>

<script>
const GROQ_API_KEY = "gsk_TU_API_KEY";
const API_URL = "https://api.groq.com/openai/v1/chat/completions";
const MODEL = "llama-3.3-70b-versatile";

let conversationHistory = [];
let instructions = "Eres un asistente útil y claro.";

const chatContainer = document.getElementById("chatContainer");
const userInput = document.getElementById("userInput");

/* Auto resize */
userInput.addEventListener("input",()=>{
  userInput.style.height="auto";
  userInput.style.height=userInput.scrollHeight+"px";
});

/* Formato seguro */
function escapeHtml(t){
  const d=document.createElement("div");
  d.textContent=t;
  return d.innerHTML;
}

function formatMessage(t){
  t=escapeHtml(t);
  t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");
  t=t.replace(/`([^`]+)`/g,"<code>$1</code>");
  t=t.replace(/```[\s\S]*?```/g,m=>`<pre><code>${m.slice(3,-3)}</code></pre>`);
  return t;
}

function addMessage(type,text){
  const div=document.createElement("div");
  div.className=`message ${type}-message`;
  div.innerHTML=formatMessage(text);
  chatContainer.appendChild(div);
  chatContainer.scrollTop=chatContainer.scrollHeight;
}

/* IA */
async function getAIResponse(msg){
  try{
    conversationHistory.push({role:"user",content:msg});

    const res = await fetch(API_URL,{
      method:"POST",
      headers:{
        "Authorization":"Bearer "+GROQ_API_KEY,
        "Content-Type":"application/json"
      },
      body:JSON.stringify({
        model:MODEL,
        messages:[
          {role:"system",content:instructions},
          ...conversationHistory
        ]
      })
    });

    const data = await res.json();

    if(!data.choices || !data.choices.length){
      return data.error?.message || "Error desconocido de la API";
    }

    const output = data.choices[0].message.content;
    conversationHistory.push({role:"assistant",content:output});
    return output;

  }catch(e){
    return "Error de conexión";
  }
}

/* Enviar */
async function sendMessage(){
  const msg=userInput.value.trim();
  if(!msg) return;

  addMessage("user",msg);
  userInput.value="";
  userInput.style.height="52px";
  userInput.disabled=true;

  const loading=document.createElement("div");
  loading.className="message ai-message";
  loading.textContent="Procesando...";
  loading.id="loading";
  chatContainer.appendChild(loading);

  const reply=await getAIResponse(msg);

  document.getElementById("loading")?.remove();
  addMessage("ai",reply);

  userInput.disabled=false;
  userInput.focus();
}

userInput.addEventListener("keypress",e=>{
  if(e.key==="Enter" && !e.shiftKey){
    e.preventDefault();
    sendMessage();
  }
});

userInput.disabled=false;
</script>

</body>
</html>
