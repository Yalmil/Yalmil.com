<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visor de Archivos .ton</title>
<link rel="icon" href="https://cdn.discordapp.com/emojis/1416607460201857168.png?v=1" type="image/png">
<meta property="og:title" content="Yalmil.com" />
<meta property="og:description" content="Visualiza archivos .ton y su descripción de juego" />
<meta property="og:image" content="https://cdn.discordapp.com/attachments/1355008732576088204/1402309070014124102/Screenshot_20250804-221210.png?ex=68937197&is=68922017&hm=1fa6f462304b2b8cf8a0875053730f988d725d114fbf2648fcb87ee1b67b6a76&" />
<meta property="og:url" content="https://yalmil.github.io/Yalmil.com/" />
<meta property="og:type" content="website" />
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
h1 { color: #333; }
#fileList { margin-top: 10px; }
#fileContent { margin-top: 20px; white-space: pre-wrap; background: #f9f9f9; padding: 10px; border: 1px solid #ccc; }
</style>
</head>
<body>
<h1>Visor de Archivos .ton</h1>
<input type="file" id="fileInput" multiple accept=".ton"><br>
<div id="fileList"></div>
<div id="fileContent"></div>

<script>
const fileInput = document.getElementById('fileInput');
const fileList = document.getElementById('fileList');
const fileContent = document.getElementById('fileContent');

fileInput.addEventListener('change', () => {
    fileList.innerHTML = '';
    fileContent.innerHTML = '';
    const files = Array.from(fileInput.files).filter(f => f.name.endsWith('.ton'));
    if(files.length === 0) {
        fileList.innerHTML = 'No se encontraron archivos .ton';
        return;
    }
    files.forEach((file, index) => {
        const btn = document.createElement('button');
        btn.textContent = `${index + 1}. ${file.name}`;
        btn.style.display = 'block';
        btn.style.marginTop = '5px';
        btn.addEventListener('click', () => readFile(file));
        fileList.appendChild(btn);
    });
});

function readFile(file) {
    const reader = new FileReader();
    reader.onload = (e) => {
        const text = e.target.result;
        fileContent.innerHTML = `<strong>Contenido de ${file.name}:</strong>\n\n${text}\n\n${parseTON(text)}`;
    };
    reader.readAsText(file);
}

function parseTON(text) {
    const lines = text.split('.');
    let description = "Descripción del juego:\nLos números sin signos son enemigos, el número indica el poder necesario para derrotarlos, si tu poder es mayor a él lo matas y se suma tu poder más el suyo.\nLos signos (-, ×, ÷) son objetos que modifican los valores indicados después del signo.\n\n";

    lines.forEach(line => {
        line = line.trim();
        if(line.startsWith('initialVal')) {
            description += `Valor inicial: ${line.split('=')[1].trim()}\n`;
        } else if(line.startsWith('not')) {
            description += `Número de torres: ${line.split('=')[1].trim()}\n`;
        } else if(line.startsWith('nwt')) {
            const values = line.split('=')[1].trim();
            description += `Nueva torre: ${values.replace(/,/g, ';')}\n`;
        } else if(line.startsWith('+')) {
            // Comentario, opcional mostrar
        }
    });

    return description;
}
</script>
</body>
</html>
