<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Battle Royale de Letras</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: #111;
      color: white;
      font-family: sans-serif;
    }
    canvas {
      display: block;
      background: radial-gradient(circle, #222, #000);
    }
    #selector {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: #222;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
    }
    #selector select, #selector button {
      padding: 10px;
      margin: 10px 0;
      font-size: 16px;
    }
    #mobile-controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
    }
    #mobile-controls button {
      background: #333;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 10px;
      font-size: 20px;
    }
  </style>
</head>
<body>
<canvas id="game"></canvas>

<div id="selector">
  <h2>Selecciona tu letra</h2>
  <select id="letraSelect">
    <!-- Generado por JS -->
  </select>
  <button onclick="iniciarJuego()">Jugar</button>
</div>

<div id="mobile-controls" style="display: none;">
  <button onclick="mov.x=-1">‚óÄÔ∏è</button>
  <button onclick="mov.y=-1">üîº</button>
  <button onclick="mov.y=1">üîΩ</button>
  <button onclick="mov.x=1">‚ñ∂Ô∏è</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player, letrasIA = [], mov = {x: 0, y: 0};
const habilidades = {
  "A": "Salto doble",
  "B": "Empuj√≥n",
  "C": "Corte lateral",
  "D": "Carga directa",
  "E": "Velocidad",
  "F": "Furia temporal",
  "G": "Golpe giratorio",
  "H": "Escudo",
  "I": "Invisible un momento",
  "J": "Salto alto",
  "K": "Empuje en l√≠nea recta",
  "L": "Lentitud a enemigos",
  "M": "Mini clones",
  "N": "Neutraliza ataques",
  "√ë": "Confusi√≥n a enemigos",
  "O": "Orbita ataques",
  "P": "Pu√±o r√°pido",
  "Q": "Quiebra terreno",
  "R": "Recupera vida",
  "S": "Sprint",
  "T": "Torbellino",
  "U": "Ultrasalto",
  "V": "Vibra al atacar",
  "W": "Whirlwind",
  "X": "X2 velocidad un rato",
  "Y": "Yoyo (rebote)",
  "Z": "Zigzag ataque"
};

function crearSelector() {
  const sel = document.getElementById("letraSelect");
  for (let letra in habilidades) {
    let opt = document.createElement("option");
    opt.value = letra;
    opt.innerText = `${letra} - ${habilidades[letra]}`;
    sel.appendChild(opt);
  }
}
crearSelector();

function iniciarJuego() {
  document.getElementById("selector").style.display = "none";
  document.getElementById("mobile-controls").style.display = "flex";
  const letraElegida = document.getElementById("letraSelect").value;
  player = crearLetra(letraElegida, canvas.width/2, canvas.height/2, true);

  // Crear 10 letras IA
  for (let i = 0; i < 10; i++) {
    const letras = Object.keys(habilidades);
    const l = letras[Math.floor(Math.random() * letras.length)];
    const x = Math.random() * canvas.width;
    const y = Math.random() * canvas.height;
    letrasIA.push(crearLetra(l, x, y, false));
  }

  gameLoop();
}

function crearLetra(letra, x, y, esJugador) {
  const color = `hsl(${Math.random()*360}, 100%, 60%)`;
  return {
    letra, x, y, color, size: 30, esJugador,
    velocidad: letra === "E" ? 5 : 3,
    zigzag: letra === "Z",
    confuse: letra === "√ë",
    dx: 0, dy: 0
  };
}

function moverIA(letra) {
  if (letra.confuse && Math.random() < 0.01) {
    letra.dx = (Math.random() - 0.5) * 6;
    letra.dy = (Math.random() - 0.5) * 6;
    return;
  }
  let dx = player.x - letra.x;
  let dy = player.y - letra.y;
  let dist = Math.sqrt(dx*dx + dy*dy);
  letra.dx = dx / dist * letra.velocidad;
  letra.dy = dy / dist * letra.velocidad;
  if (letra.zigzag) {
    letra.dx += Math.sin(Date.now() / 100) * 2;
    letra.dy += Math.cos(Date.now() / 100) * 2;
  }
}

function colision(a, b) {
  const dx = a.x - b.x;
  const dy = a.y - b.y;
  return Math.sqrt(dx*dx + dy*dy) < a.size;
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Fondo aleatorio
  document.body.style.background = `radial-gradient(circle, hsl(${Date.now()/20 % 360}, 60%, 20%), black)`;

  // Mover jugador
  player.x += mov.x * player.velocidad;
  player.y += mov.y * player.velocidad;

  // Dibujar jugador
  ctx.fillStyle = player.color;
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.size, 0, Math.PI*2);
  ctx.fill();
  ctx.fillStyle = "#fff";
  ctx.font = "20px Arial";
  ctx.fillText(player.letra, player.x - 7, player.y + 7);

  // Mover y dibujar letras IA
  for (let i = letrasIA.length - 1; i >= 0; i--) {
    const l = letrasIA[i];
    moverIA(l);
    l.x += l.dx;
    l.y += l.dy;
    ctx.fillStyle = l.color;
    ctx.beginPath();
    ctx.arc(l.x, l.y, l.size, 0, Math.PI*2);
    ctx.fill();
    ctx.fillStyle = "#fff";
    ctx.fillText(l.letra, l.x - 7, l.y + 7);

    if (colision(l, player)) {
      alert("¬°Perdiste! Te atrap√≥ la letra " + l.letra);
      location.reload();
      return;
    }
  }

  requestAnimationFrame(gameLoop);
}

// Controles PC
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") mov.x = -1;
  if (e.key === "ArrowRight") mov.x = 1;
  if (e.key === "ArrowUp") mov.y = -1;
  if (e.key === "ArrowDown") mov.y = 1;
});
document.addEventListener("keyup", e => {
  if (["ArrowLeft", "ArrowRight"].includes(e.key)) mov.x = 0;
  if (["ArrowUp", "ArrowDown"].includes(e.key)) mov.y = 0;
});
</script>
</body>
</html>
